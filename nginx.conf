events {
    worker_connections 1024;
}

http {
    upstream camera_left {
        server camera-left:80;
    }
    
    upstream camera_right {
        server camera-right:80;
    }

    # Left camera server (simulates 150deaa5.duckdns.org)
    server {
        listen 80;
        server_name left.localhost 150deaa5.duckdns.org;
        
        location / {
            proxy_pass http://camera_left;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }

    # Right camera server (simulates c4df83c4.duckdns.org)
    server {
        listen 80;
        server_name right.localhost c4df83c4.duckdns.org;
        
        location / {
            proxy_pass http://camera_right;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }

    # Default server for direct access
    server {
        listen 80 default_server;
        
        location / {
            return 200 '
<!DOCTYPE html>
<html>
<head><title>Sani Flush Camera System</title></head>
<body>
    <h1>Sani Flush Camera System</h1>
    <p><a href="http://left.localhost">Left Camera</a> (Port 8080)</p>
    <p><a href="http://right.localhost">Right Camera</a> (Port 8081)</p>
</body>
</html>';
            add_header Content-Type text/html;
        }
    }
}